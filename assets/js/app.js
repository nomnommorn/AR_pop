!function(t){var e={};function r(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=e,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(i,n,function(e){return t[e]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(t){var e={};function r(i){if(e[i])return e[i].exports;var n=e[i]={exports:{},id:i,loaded:!1};return t[i].call(n.exports,n,n.exports,r),n.loaded=!0,n.exports}r.m=t,r.c=e,r.p="",r(0)}([function(t,e,i){"use strict";var n="function"==typeof Symbol&&"symbol"===r(Symbol.iterator)?function(t){return r(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":r(t)},a=i(1);if("undefined"==typeof AFRAME)throw"Component attempted to register before AFRAME was available.";var s=AFRAME.utils.srcLoader.parseUrl,o=AFRAME.utils.debug;o.enable("shader:gif:warn");var u=o("shader:gif:warn"),_=o("shader:gif:debug"),c={};function l(t,e){return{status:"error",src:e,message:t,timestamp:Date.now()}}AFRAME.registerShader("gif",{schema:{color:{type:"color"},fog:{default:!0},src:{default:null},autoplay:{default:!0}},init:function(t){return _("init",t),_(this.el.components),this.__cnv=document.createElement("canvas"),this.__cnv.width=2,this.__cnv.height=2,this.__ctx=this.__cnv.getContext("2d"),this.__texture=new THREE.Texture(this.__cnv),this.__material={},this.__reset(),this.material=new THREE.MeshBasicMaterial({map:this.__texture}),this.el.sceneEl.addBehavior(this),this.__addPublicFunctions(),this.material},update:function(t){return _("update",t),this.__updateMaterial(t),this.__updateTexture(t),this.material},tick:function(t){this.__frames&&!this.paused()&&Date.now()-this.__startTime>=this.__nextFrameTime&&this.nextFrame()},__updateMaterial:function(t){var e=this.material,r=this.__getMaterialData(t);Object.keys(r).forEach((function(t){e[t]=r[t]}))},__getMaterialData:function(t){return{fog:t.fog,color:new THREE.Color(t.color)}},__setTexure:function(t){_("__setTexure",t),"error"===t.status?(u("Error: "+t.message+"\nsrc: "+t.src),this.__reset()):"success"===t.status&&t.src!==this.__textureSrc&&(this.__reset(),this.__ready(t))},__updateTexture:function(t){var e=t.src,r=t.autoplay;"boolean"==typeof r?this.__autoplay=r:void 0===r&&(this.__autoplay=!0),this.__autoplay&&this.__frames&&this.play(),e?this.__validateSrc(e,this.__setTexure.bind(this)):this.__reset()},__validateSrc:function(t,e){var r=s(t);if(r)this.__getImageSrc(r,e);else{var i=void 0,a=this.__validateAndGetQuerySelector(t);if(a&&"object"===(void 0===a?"undefined":n(a))){if(a.error)i=a.error;else{var o=a.tagName.toLowerCase();if("video"===o)t=a.src,i="For video, please use `aframe-video-shader`";else{if("img"===o)return void this.__getImageSrc(a.src,e);i="For <"+o+"> element, please use `aframe-html-shader`"}}var u,_;i&&(u=c[t],_=l(i,t),u&&u.callbacks?u.callbacks.forEach((function(t){return t(_)})):e(_),c[t]=_)}}},__getImageSrc:function(t,e){var r=this;if(t!==this.__textureSrc){var i=c[t];if(i&&i.callbacks){if(i.src)return void e(i);if(i.callbacks)return void i.callbacks.push(e)}else(i=c[t]={callbacks:[]}).callbacks.push(e);var n=new Image;n.crossOrigin="Anonymous",n.addEventListener("load",(function(e){r.__getUnit8Array(t,(function(e){e?(0,a.parseGIF)(e,(function(e,r,n){var a={status:"success",src:t,times:e,cnt:r,frames:n,timestamp:Date.now()};i.callbacks&&(i.callbacks.forEach((function(t){return t(a)})),c[t]=a)}),(function(t){return s(t)})):s("This is not gif. Please use `shader:flat` instead")}))})),n.addEventListener("error",(function(t){return s("Could be the following issue\n - Not Image\n - Not Found\n - Server Error\n - Cross-Origin Issue")})),n.src=t}function s(e){var r=l(e,t);i.callbacks&&(i.callbacks.forEach((function(t){return t(r)})),c[t]=r)}},__getUnit8Array:function(t,e){if("function"==typeof e){var r=new XMLHttpRequest;r.open("GET",t),r.responseType="arraybuffer",r.addEventListener("load",(function(t){for(var r=new Uint8Array(t.target.response),i=r.subarray(0,4),n="",a=0;a<i.length;a++)n+=i[a].toString(16);"47494638"===n?e(r):e()})),r.addEventListener("error",(function(t){_(t),e()})),r.send()}},__validateAndGetQuerySelector:function(t){try{var e=document.querySelector(t);return e||{error:"No element was found matching the selector"}}catch(t){return{error:"no valid selector"}}},__addPublicFunctions:function(){this.el.gif={play:this.play.bind(this),pause:this.pause.bind(this),togglePlayback:this.togglePlayback.bind(this),paused:this.paused.bind(this),nextFrame:this.nextFrame.bind(this)}},pause:function(){_("pause"),this.__paused=!0},play:function(){_("play"),this.__paused=!1},togglePlayback:function(){this.paused()?this.play():this.pause()},paused:function(){return this.__paused},nextFrame:function(){for(this.__clearCanvas(),this.__draw();Date.now()-this.__startTime>=this.__nextFrameTime;)this.__nextFrameTime+=this.__delayTimes[this.__frameIdx++],(this.__infinity||this.__loopCnt)&&this.__frameCnt<=this.__frameIdx&&(this.__frameIdx=0)},__clearCanvas:function(){this.__ctx.clearRect(0,0,this.__width,this.__height),this.__texture.needsUpdate=!0},__draw:function(){this.__ctx.drawImage(this.__frames[this.__frameIdx],0,0,this.__width,this.__height),this.__texture.needsUpdate=!0},__ready:function(t){var e=t.src,r=t.times,i=t.cnt,n=t.frames;_("__ready"),this.__textureSrc=e,this.__delayTimes=r,i?this.__loopCnt=i:this.__infinity=!0,this.__frames=n,this.__frameCnt=r.length,this.__startTime=Date.now(),this.__width=THREE.Math.floorPowerOfTwo(n[0].width),this.__height=THREE.Math.floorPowerOfTwo(n[0].height),this.__cnv.width=this.__width,this.__cnv.height=this.__height,this.__draw(),this.__autoplay?this.play():this.pause()},__reset:function(){this.pause(),this.__clearCanvas(),this.__startTime=0,this.__nextFrameTime=0,this.__frameIdx=0,this.__frameCnt=0,this.__delayTimes=null,this.__infinity=!1,this.__loopCnt=0,this.__frames=null,this.__textureSrc=null}})},function(t,e){"use strict";e.parseGIF=function(t,e,r){var i=0,n=[],a=0,s=null,o=null,u=[],_=0;if(71===t[0]&&73===t[1]&&70===t[2]&&56===t[3]&&57===t[4]&&97===t[5]){i+=13+ +!!(128&t[10])*Math.pow(2,1+(7&t[10]))*3;for(var c=t.subarray(0,i);t[i]&&59!==t[i];){var l=i,h=t[i];if(33===h){var f=t[++i];if(-1===[1,254,249,255].indexOf(f)){r&&r("parseGIF: unknown label");break}for(249===f&&n.push(10*(t[i+3]+(t[i+4]<<8))),255===f&&(_=t[i+15]+(t[i+16]<<8));t[++i];)i+=t[i];249===f&&(s=t.subarray(l,i+1))}else{if(44!==h){r&&r("parseGIF: unknown blockId");break}for(i+=9,i+=1+ +!!(128&t[i])*(3*Math.pow(2,1+(7&t[i])));t[++i];)i+=t[i];o=t.subarray(l,i+1);u.push(URL.createObjectURL(new Blob([c,s,o])))}i++}}else r&&r("parseGIF: no GIF89a");if(u.length){var d=document.createElement("canvas"),p=function t(r){var i=new Image;i.onload=function(r,i){a++,u[i]=this,a===u.length?(d=null,e&&e(n,_,u)):t(++i)}.bind(i),i.src=d.toDataURL("image/gif")};u.forEach((function(t,e){var r=new Image;r.onload=function(t,e){0===e&&(d.width=r.width,d.height=r.height),a++,u[e]=this,a===u.length&&(a=0,p(1))}.bind(r,null,e),r.src=t}))}}}])}]);
//# sourceMappingURL=app.js.map